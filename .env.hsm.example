# Freebird Issuer Configuration - HSM Mode
# This example shows how to configure Freebird to use HSM for key storage
# while keeping VOPRF operations in software for performance.

# Issuer Configuration
ISSUER_ID=issuer:freebird:hsm:v1
BIND_ADDR=0.0.0.0:8081
TOKEN_TTL_MIN=10
REQUIRE_TLS=false
BEHIND_PROXY=false

# Epoch Configuration (for key rotation)
EPOCH_DURATION_SEC=86400  # 1 day
EPOCH_RETENTION=2         # Accept tokens from 2 previous epochs

# HSM Configuration
HSM_ENABLE=true

# HSM Mode:
# - "storage": Keys stored in HSM, extracted for software VOPRF operations (RECOMMENDED)
#              Provides key protection at rest with fast operations
# - "full":    All operations in HSM (NOT YET IMPLEMENTED)
#              Would provide full HSM protection but slower
HSM_MODE=storage

# PKCS#11 Module Path (depends on HSM type)
# SoftHSM (for testing):
HSM_MODULE_PATH=/usr/lib/softhsm/libsofthsm2.so
# YubiHSM:
# HSM_MODULE_PATH=/usr/lib/libykcs11.so
# Nitrokey HSM (via OpenSC):
# HSM_MODULE_PATH=/usr/lib/x86_64-linux-gnu/opensc-pkcs11.so

# HSM Slot Number
# Use 'pkcs11-tool --module <path> --list-slots' to find available slots
HSM_SLOT=0

# HSM PIN
# WARNING: In production, use a secrets manager instead of .env file
HSM_PIN=1234

# Key Label in HSM
# This is the label assigned to the P-256 key in the HSM
HSM_KEY_LABEL=freebird-voprf-key

# Traditional Key Storage (used as fallback if HSM fails or for migration)
ISSUER_SK_PATH=issuer_sk.bin
KEY_ROTATION_STATE_PATH=key_rotation_state.json

# Sybil Resistance (optional)
SYBIL_RESISTANCE=none
# Options: none, invitation, pow, rate_limit, combined

# Admin API (optional)
# ADMIN_API_KEY=your-secret-admin-key-here
